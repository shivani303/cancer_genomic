#reading a csv file
data= read.csv("C:/Users/shiva/Desktop/shivani college/rgitbt/cancer genomics/leukemia.csv")
data
dim(data)
#removing gene name column
countdata <- data[,-1]
countdata[,20] = NULL
head(countdata)

# Store Genename as rownames
rownames(countdata) <- data[,1]
head(countdata)

 #Convert counts to DGEList object
library(edgeR)
library(limma)
y <- DGEList(countdata)
print(head(y))

# See what slots are stored in y
names(y)
cpm_data=cpm(y)
cpm_data
log_data<- cpm(countdata, log=TRUE)
log_data

#checking that data is normalised or not
boxplot(log_data) # data is normalised

#HEATMAP
library(gplots)
heatmap.2(log_data[1:30,],scale = 'row')


#DIFFERENTIAL GENE EXPRESSION
cdata = log_data[,1:3] #control
head(cdata)
tdata = log_data[,4:19] #test
head(tdata)

#logfc2 value
logfc2= list() #creating an empty list
for(i in 1 : nrow(countdata)) { # For each gene : 
  x = cdata[i,] # cdata of gene number i
  y = tdata[i,]
  logfc= mean(x)-mean(y)
  logfc2 = append(logfc2,logfc)
}
print(logfc2)
unlist(logfc2) #convert list to vector
typeof(logfc2)
list1=list(data[,1]) #storing gene names in variable
print(list1)
unlist(list1) #converting list to vector
deg= data.frame(list1,logfc2) #creating dataframe
colnames(deg)<- c("genename","logfc2") #setting column name in dataframe
head(deg)
